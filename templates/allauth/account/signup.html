{% extends "base.html" %}

{% block content %}
<div class="container mt-5 my-5">
    <div class="row gy-4">

        {% if messages %}
    <div class="alert alert-danger">
        <ul>
            {% for message in messages %}
                <li>{{ message }}</li>
            {% endfor %}
        </ul>
    </div>
{% endif %}

        <!-- Form Section -->
        <div class="col-lg-8 col-md-12 bg-dark text-white p-5 rounded shadow-lg">
            <h1 class="text-center mb-4">Register a New Account</h1>
            <form class="custom-form" method="post" action="{% url 'account_signup' %}">
                {% csrf_token %}
                {{ form.non_field_errors }}

                <h5>Personal Details</h5>
                <!-- Personal Details -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.first_name }}
                        {% for error in form.first_name.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-6">
                        {{ form.last_name }}
                        {% for error in form.last_name.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.email }}
                        {% for error in form.email.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-6">
                        {{ form.email2 }}
                        {% for error in form.email2.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Contact Details -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.contact_number }}
                        {% for error in form.contact_number.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Address Details -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.address }}
                        {% for error in form.address.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-6">
                        {{ form.address_line2 }}
                        {% for error in form.address_line2.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.city }}
                        {% for error in form.city.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="col-md-6">
                        {{ form.county }}
                        {% for error in form.county.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.post_code }}
                        {% for error in form.post_code.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <h5 class="text-primary">Company Details (Business Use Only)</h5>
                <!-- Company Details -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.company_name }}
                        {% for error in form.company_name.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <h5 class="text-primary">Login Details</h5>
                <!-- Login Details -->
                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.username }}
                        {% for error in form.username.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                        <small class="text-muted">
                            We recommend using your email address as your username. 
                            However, you are welcome to choose another username. 
                            It must be at least 5 characters long. 
                            Keep your username and password safe.
                        </small>
                    </div>
                    <div class="col-md-6">
                        {{ form.password1 }}
                        {% for error in form.password1.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        {{ form.password2 }}
                        {% for error in form.password2.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                </div>

                <!-- Terms and Submit -->
                <div class="form-check mb-4">
                    {{ form.agree_to_terms }}
                    <label class="form-check-label" for="{{ form.agree_to_terms.id_for_label }}">
                        I agree to the
                        <a href="#" class="text-warning" data-toggle="modal" data-target="#contentModal" data-url="{% url 'terms' %}" data-title="Terms & Conditions">Terms of Website Use</a>
and
<a href="#" class="text-warning" data-toggle="modal" data-target="#contentModal" data-url="{% url 'policy' %}" data-title="Privacy Policy">Privacy Policy</a>

                    </label>
                    {% for error in form.agree_to_terms.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>

<!-- Bootstrap Modal -->
<div class="modal fade" id="contentModal" tabindex="-1" aria-labelledby="contentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contentModalLabel">Content</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <!-- Content will be loaded here -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
                {% if form.errors %}
                    <div class="alert alert-danger">
                        <p><strong>Please correct the errors below:</strong></p>
                        <ul>
                            {% for field, errors in form.errors.items %}
                                <li>{{ field }}: {{ errors|join:", " }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}

                <button type="submit" class="btn btn-pink w-100">Create My Account</button>
            </form>
        </div>

        <!-- Help Section -->
        <div class="col-lg-4 col-md-12 text-center bg-pink text-white py-5 rounded help-section">
            <h5>Need help? Call us</h5>
            <h2 class="fw-bold">0800 123 1234</h2>
        </div>
    </div>
</div>

<style>
    .btn-pink {
        background-color: #ff0066;
        color: #fff;
        padding: 12px 20px;
        font-size: 18px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .btn-pink:hover {
        background-color: #e6005c;
    }

    .bg-pink {
        background-color: #ff0066;
    }

    .help-section {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
    }

    .custom-form input, 
    .custom-form select, 
    .custom-form textarea {
        display: block;
        width: 100%;
        padding: 0.75rem;
        font-size: 1rem;
        line-height: 1.5;
        color: #495057;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 0.375rem;
        transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
    }

    .custom-form input:focus, 
    .custom-form select:focus, 
    .custom-form textarea:focus {
        border-color: #ff0066;
        box-shadow: 0 0 0 0.25rem rgba(255, 0, 102, 0.541);
    }

    .form-check {
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .form-check-label {
        margin: 0;
        font-size: 1rem;
        color: #fff;
    }

    .form-check input[type="checkbox"] {
        width: 20px;
        height: 20px;
    }

/* Modal Styling */
#contentModal .modal-dialog {
    max-width: 800px; /* Set maximum width for the modal */
    margin: 30px auto;
}

#contentModal .modal-header {
    background-color: #ff0066; /* Header background color */
    color: white; /* Header text color */
    border-bottom: 2px solid #000000; /* Subtle border */
    padding: 15px;
    font-size: 1.5rem; /* Header text size */
}

#contentModal .modal-body {
    padding: 20px;
    max-height: 70vh; /* Limit the height of the modal body */
    overflow-y: auto; /* Enable scrolling for long content */
    font-family: 'Arial', sans-serif; /* Readable font */
    font-size: 1rem; /* Base font size */
    line-height: 1.6; /* Improve text readability */
    color: #333; /* Text color */
}

#contentModal .modal-footer {
    padding: 15px;
    text-align: right;
    background-color: #f8f9fa; /* Light footer background */
    border-top: 1px solid #ddd; /* Subtle top border */
}

/* Content Styling */
#contentModal .modal-body h1,
#contentModal .modal-body h2 {
    color: #ff0066; /* Match header color */
    margin-bottom: 1rem;
    border-bottom: 2px solid #ff0066;
    padding-bottom: 0.5rem;
}

#contentModal .modal-body p {
    margin-bottom: 1rem;
    color: #444; /* Slightly lighter text for paragraphs */
}

#contentModal .modal-body ul {
    margin-bottom: 1.5rem;
}

#contentModal .modal-body a {
    color: #0056b3;
    text-decoration: underline;
}

#contentModal .modal-body a:hover {
    color: #004080;
    text-decoration: none;
}

/* Button Styling */
#contentModal .modal-footer button {
    background-color: #0056b3; /* Primary button background */
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 1rem;
    border-radius: 5px;
    cursor: pointer;
}

#contentModal .modal-footer button:hover {
    background-color: #004080; /* Darker shade on hover */
}

/* Responsive Design */
@media (max-width: 768px) {
    #contentModal .modal-dialog {
        max-width: 90%; /* Adjust modal width for smaller screens */
    }

    #contentModal .modal-header {
        font-size: 1.25rem; /* Smaller header text */
    }

    #contentModal .modal-body {
        font-size: 0.9rem; /* Adjust font size */
    }
}



</style>


<script>
    // Add Bootstrap classes to form elements
    document.querySelectorAll('form input, form select, form textarea').forEach((element) => {
        element.classList.add('form-control');
    });

    document.querySelectorAll('a[data-toggle="modal"]').forEach((link) => {
        link.addEventListener('click', (event) => {
            event.preventDefault();

            const url = link.getAttribute('data-url');
            const title = link.getAttribute('data-title'); // Get the title from the data-title attribute

            // Update the modal title
            const modalTitle = document.querySelector('#contentModalLabel');
            if (modalTitle) {
                modalTitle.textContent = title;
            }

            // Fetch and load the modal content
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    const tempDiv = document.createElement('div');
                    tempDiv.innerHTML = data;

                    const blockContent = tempDiv.querySelector('main.content.container') || tempDiv.querySelector('div.container');

                    const modalContent = document.querySelector('#contentModal .modal-body');
                    if (blockContent) {
                        modalContent.innerHTML = blockContent.innerHTML;
                    } else {
                        modalContent.innerHTML = '<p>Error: Content block not found.</p>';
                    }
                })
                .catch(error => {
                    console.error('Error fetching content:', error);
                    document.querySelector('#contentModal .modal-body').innerHTML = '<p>Error fetching content.</p>';
                });
        });
    });

    
   
</script>

{% endblock %}
